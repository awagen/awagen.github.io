<!doctype html><html lang=en class="js csstransforms3d"><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=generator content="Hugo 0.110.0"><meta name=description content><link rel="shortcut icon" href=/images/kolibri.svg type=image/x-icon><title>Getting it started :: Kolibri Documentation</title><link href=/css/nucleus.css?1691615470 rel=stylesheet><link href=/css/fontawesome-all.min.css?1691615470 rel=stylesheet><link href=/css/hybrid.css?1691615470 rel=stylesheet><link href=/css/featherlight.min.css?1691615470 rel=stylesheet><link href=/css/perfect-scrollbar.min.css?1691615470 rel=stylesheet><link href=/css/auto-complete.css?1691615470 rel=stylesheet><link href=/css/atom-one-dark-reasonable.css?1691615470 rel=stylesheet><link href=/css/theme.css?1691615470 rel=stylesheet><link href=/css/tabs.css?1691615470 rel=stylesheet><link href=/css/hugo-theme.css?1691615470 rel=stylesheet><script src=/js/jquery-3.3.1.min.js?1691615470></script><style>:root #header+#content>#left>#rlblock_left{display:none!important}</style></head><body data-url=/kolibri_archive/kolibri-base/1-basics/1-runningit/><nav id=sidebar><div id=header-wrapper><div id=header><img src=/images/kolibri.svg alt=Kolibri height=100><div>HOME OF KOLIBRI</div></div><div class=searchbox><label for=search-by><i class="fas fa-search"></i></label>
<input data-search-input id=search-by type=search placeholder=Search...>
<span data-search-clear><i class="fas fa-times"></i></span></div><script type=text/javascript src=/js/lunr.min.js?1691615470></script>
<script type=text/javascript src=/js/auto-complete.js?1691615470></script>
<script type=text/javascript>var baseurl="http://awagen.github.io/"</script><script type=text/javascript src=/js/search.js?1691615470></script></div><section id=homelinks><ul><li><a class=padding href=/><i class='fas fa-home'></i> Home</a></li></ul></section><div class=highlightable><ul class=topics><li data-nav-id=/kolibri/ title="Kolibri Documentation" class=dd-item><a href=/kolibri/>Kolibri Documentation</a><ul><li data-nav-id=/kolibri/first-steps/ title="First Steps" class=dd-item><a href=/kolibri/first-steps/>First Steps</a><ul><li data-nav-id=/kolibri/first-steps/1-getting-started/ title="Configure / Run" class=dd-item><a href=/kolibri/first-steps/1-getting-started/><b>1. </b>Configure And Run</a></li><li data-nav-id=/kolibri/first-steps/2-using-the-ui/ title="Usage via UI" class=dd-item><a href=/kolibri/first-steps/2-using-the-ui/><b>2. </b>Usage via UI</a></li><li data-nav-id=/kolibri/first-steps/3-useful-examples-pt1/ title="Actually useful examples Pt1 - Composing a job definition / Aggregation" class=dd-item><a href=/kolibri/first-steps/3-useful-examples-pt1/><b>3. </b>Actually useful examples Pt1 - Composing a job definition / Aggregation</a></li><li data-nav-id=/kolibri/first-steps/4-useful-examples-pt2/ title="Actually useful examples Pt2 - Comparing search systems" class=dd-item><a href=/kolibri/first-steps/4-useful-examples-pt2/><b>4. </b>Actually useful examples Pt2 - Comparing search systems</a></li><li data-nav-id=/kolibri/first-steps/5-troubleshoot/ title=Troubleshoot class=dd-item><a href=/kolibri/first-steps/5-troubleshoot/><b>5. </b>Troubleshoot</a></li><li data-nav-id=/kolibri/first-steps/6-api-endpoints/ title="API Endpoints" class=dd-item><a href=/kolibri/first-steps/6-api-endpoints/><b>6. </b>API Endpoints</a></li></ul></li></ul></li><li data-nav-id=/kolibri_archive/ title="Kolibri Documentation (Archive / Deprecated)" class="dd-item
parent"><a href=/kolibri_archive/>Kolibri Documentation (Archive / Deprecated)</a><ul><li data-nav-id=/kolibri_archive/kolibri-datatypes/ title="Kolibri-DataTypes Documentation" class=dd-item><a href=/kolibri_archive/kolibri-datatypes/>Kolibri-DataTypes Documentation</a><ul><li data-nav-id=/kolibri_archive/kolibri-datatypes/1-types/ title=Types class=dd-item><a href=/kolibri_archive/kolibri-datatypes/1-types/><b>1. </b>Types</a><ul><li data-nav-id=/kolibri_archive/kolibri-datatypes/1-types/1-categories/ title="DataType Categories" class=dd-item><a href=/kolibri_archive/kolibri-datatypes/1-types/1-categories/><b>1 - </b>DataType Categories</a></li></ul></li></ul></li><li data-nav-id=/kolibri_archive/kolibri-base/ title="Kolibri-Base Documentation" class="dd-item
parent"><a href=/kolibri_archive/kolibri-base/>Kolibri-Base Documentation</a><ul><li data-nav-id=/kolibri_archive/kolibri-base/1-basics/ title=Basics class="dd-item
parent"><a href=/kolibri_archive/kolibri-base/1-basics/><b>1. </b>Basics</a><ul><li data-nav-id=/kolibri_archive/kolibri-base/1-basics/1-runningit/ title="Getting it started" class="dd-item active"><a href=/kolibri_archive/kolibri-base/1-basics/1-runningit/><b>1 - </b>Getting it started</a></li><li data-nav-id=/kolibri_archive/kolibri-base/1-basics/2-monitoring/ title=Monitoring class=dd-item><a href=/kolibri_archive/kolibri-base/1-basics/2-monitoring/><b>2 - </b>Monitoring</a></li><li data-nav-id=/kolibri_archive/kolibri-base/1-basics/3-executeexamplejob/ title="Executing examples" class=dd-item><a href=/kolibri_archive/kolibri-base/1-basics/3-executeexamplejob/><b>3 - </b>Executing examples</a></li></ul></li><li data-nav-id=/kolibri_archive/kolibri-base/2-mechanisms/ title=Mechanisms class=dd-item><a href=/kolibri_archive/kolibri-base/2-mechanisms/><b>2. </b>Mechanisms</a><ul><li data-nav-id=/kolibri_archive/kolibri-base/2-mechanisms/1-overview/ title=Basics class=dd-item><a href=/kolibri_archive/kolibri-base/2-mechanisms/1-overview/><b>1 - </b>Basics</a></li></ul></li><li data-nav-id=/kolibri_archive/kolibri-base/3-step-by-step/ title="Step-by-Step Guide" class=dd-item><a href=/kolibri_archive/kolibri-base/3-step-by-step/><b>3. </b>Step-by-Step Guide</a><ul><li data-nav-id=/kolibri_archive/kolibri-base/3-step-by-step/0-overview/ title=Overview class=dd-item><a href=/kolibri_archive/kolibri-base/3-step-by-step/0-overview/><b>0 - </b>Overview</a></li><li data-nav-id=/kolibri_archive/kolibri-base/3-step-by-step/1-values/ title=Values class=dd-item><a href=/kolibri_archive/kolibri-base/3-step-by-step/1-values/><b>1 - </b>Values</a></li><li data-nav-id=/kolibri_archive/kolibri-base/3-step-by-step/2-generators/ title=Generators class=dd-item><a href=/kolibri_archive/kolibri-base/3-step-by-step/2-generators/><b>2 - </b>Generators</a></li><li data-nav-id=/kolibri_archive/kolibri-base/3-step-by-step/3-tags/ title=Tagging class=dd-item><a href=/kolibri_archive/kolibri-base/3-step-by-step/3-tags/><b>3 - </b>Tagging</a></li><li data-nav-id=/kolibri_archive/kolibri-base/3-step-by-step/4-processing-messages/ title="Processing Messages / Aggregation States" class=dd-item><a href=/kolibri_archive/kolibri-base/3-step-by-step/4-processing-messages/><b>4 - </b>Processing Messages / Aggregation States</a></li><li data-nav-id=/kolibri_archive/kolibri-base/3-step-by-step/5-writers/ title="Formats & Writers" class=dd-item><a href=/kolibri_archive/kolibri-base/3-step-by-step/5-writers/><b>5 - </b>Formats & Writers</a></li></ul></li><li data-nav-id=/kolibri_archive/kolibri-base/4-inputs/ title=Inputs class=dd-item><a href=/kolibri_archive/kolibri-base/4-inputs/><b>4. </b>Inputs</a></li></ul></li><li data-nav-id=/kolibri_archive/kolibri-watch/ title="Kolibri-Watch Documentation" class=dd-item><a href=/kolibri_archive/kolibri-watch/>Kolibri-Watch Documentation</a><ul><li data-nav-id=/kolibri_archive/kolibri-watch/1-ui/ title="UI - Kolibri Watch" class=dd-item><a href=/kolibri_archive/kolibri-watch/1-ui/><b>1. </b>UI - Kolibri Watch</a><ul><li data-nav-id=/kolibri_archive/kolibri-watch/1-ui/1-overview/ title=Overview class=dd-item><a href=/kolibri_archive/kolibri-watch/1-ui/1-overview/><b>1 - </b>Overview</a></li></ul></li></ul></li></ul></li></ul><section id=shortcuts><h3>More</h3><ul><li><a class=padding href=https://github.com/awagen/kolibri/tree/main/kolibri-datatypes><i class='fab fa-github'></i> Github kolibri-datatypes repo</a></li><li><a class=padding href=https://github.com/awagen/kolibri/tree/main/kolibri-storage><i class='fab fa-github'></i> Github kolibri-storage repo</a></li><li><a class=padding href=https://github.com/awagen/kolibri/tree/main/kolibri-definitions><i class='fab fa-github'></i> Github kolibri-definitions repo</a></li><li><a class=padding href=https://github.com/awagen/kolibri/tree/main/kolibri-fleet-zio><i class='fab fa-github'></i> Github kolibri-fleet-zio repo</a></li><li><a class=padding href=https://github.com/awagen/kolibri/tree/main/kolibri-watch><i class='fab fa-github'></i> Github kolibri-watch repo</a></li><li><a class=padding href=https://github.com/awagen/response-juggler><i class='fab fa-github'></i> Github response-juggler repo</a></li><li><a class=padding href=https://www.linkedin.com/in/andreas-wagenmann/><i class='fab fa-linkedin'></i> LinkedIn</a></li><li><a class=padding href=https://twitter.com/andiwagen><i class='fab fa-twitter'></i> Twitter</a></li></ul></section><section id=footer></section></div></nav><section id=body><div id=overlay></div><div class="padding highlightable"><div><div id=top-bar><div id=breadcrumbs itemscope itemtype=http://data-vocabulary.org/Breadcrumb><span id=sidebar-toggle-span><a href=# id=sidebar-toggle data-sidebar-toggle><i class="fas fa-bars"></i></a></span>
<span id=toc-menu><i class="fas fa-list-alt"></i></span>
<span class=links><a href=/>Home</a> > <a href=/kolibri_archive/>Kolibri Documentation (Archive / Deprecated)</a> > <a href=/kolibri_archive/kolibri-base/>Kolibri-Base Documentation</a> > <a href=/kolibri_archive/kolibri-base/1-basics/>Basics</a> > Getting it started</span></div><div class=progress><div class=wrapper><nav id=TableOfContents><ul><li><a href=#starting-locally-with-docker-compose>Starting locally with docker-compose</a></li><li><a href=#configuration-options-in-detail>Configuration Options in Detail</a></li></ul></nav></div></div></div></div><div id=head-tags></div><div id=body-inner><h1>Getting it started</h1><p>Lets first dive into how to get the project started on your machine.
There are multiple configuration options available, which will be detailled in the following.</p><h2 id=starting-locally-with-docker-compose>Starting locally with docker-compose</h2><p>Find the docker compose in project root.
If youre referencing an existing image, you dont need to build anything beforehand.
In case you want to start a local version, make sure to package the jar,
create the properly tagged docker image and reference this in the docker-compose.
The steps for this would be (assuming youre in the project root folder):</p><ol><li>(Optional; the docker-compose file references a public image provided in public dockerhub repo) Build docker image:<ol><li><code>./scripts/buildJar.sh</code></li><li><code>docker build . -t kolibri-base:[versionTag]</code> (e.g versionTag = 0.1.0-rc0)</li></ol></li><li>set the correct version in the docker-compose.yml kolibri image setting<ol><li><code>awagen/kolibri-base:[versionTag]</code> (for publicly available images)</li><li><code>kolibri-base:[versionTag]</code> (in case of custom local build)</li></ol></li><li>(Optional) repeat above steps for the kolibri-watch project and response-juggler (only needed in case you dont wanna use the referenced public docker images)</li><li>start up the kolibri cluster along with prometheus and grafana, kolibri-watch and response-juggler: <code>docker-compose up</code></li></ol><p>Note that this is a complete setup where response-juggler just creates fake-responses to mock a real search system
according to some sampling criteria (check the project itself for more details, <a href=https://github.com/awagen/response-juggler>https://github.com/awagen/response-juggler</a>).
If you want to execute the jobs on an actual search system, you only need to reference the right
connections in your job definition (and you can comment out the response juggler from the docker-compose).</p><p>Lets go over the settings configurable by passing env vars, taking the docker-compose
file as example:</p><pre tabindex=0><code>kolibri1:
    image: awagen/kolibri-base:0.1.0-rc0
    ports:
      - &#34;8000:8000&#34;
      - &#34;5266:5266&#34;
      - &#34;9095:9095&#34;
    user: &#34;1000:1000&#34;
    environment:
      JVM_OPTS: &gt;
        -XX:+UseG1GC
        -Xms1024m
        -Xmx4096m
      PROFILE: prod
      ROLES: httpserver
      KAMON_PROMETHEUS_PORT: 9095
      KAMON_STATUSPAGE_PORT: 5266
      CLUSTER_NODE_HOST: kolibri1
      CLUSTER_NODE_PORT: 8001
      HTTP_SERVER_INTERFACE: kolibri1
      HTTP_SERVER_PORT: 8000
      MANAGEMENT_HOST: kolibri1
      MANAGEMENT_PORT: 8558
      MANAGEMENT_BIND_HOSTNAME: &#39;0.0.0.0&#39;
      MANAGEMENT_BIND_PORT: 8558
      CLUSTER_NODE_BIND_HOST: &#39;0.0.0.0&#39;
      CLUSTER_NODE_BIND_PORT: 8001
      DISCOVERY_SERVICE_NAME: kolibri-service
      KOLIBRI_ACTOR_SYSTEM_NAME: KolibriAppSystem
      DISCOVERY_METHOD: config
      REQUEST_PARALLELISM: 16
      USE_CONNECTION_POOL_FLOW: &#39;false&#39;
      RUNNING_TASK_BASELINE_COUNT: 2
      KOLIBRI_DISPATCHER_PARALLELISM_MIN: 8
      KOLIBRI_DISPATCHER_PARALLELISM_FACTOR: 8.0
      KOLIBRI_DISPATCHER_PARALLELISM_MAX: 32
      KOLIBRI_DISPATCHER_THROUGHPUT: 10
      DEFAULT_DISPATCHER_PARALLELISM_FACTOR: 1.0
      DEFAULT_DISPATCHER_PARALLELISM_MAX: 2
      DEFAULT_DISPATCHER_PARALLELISM_MIN: 1
      HTTP_CLIENT_CONNECTION_TIMEOUT: &#39;5s&#39;
      HTTP_CLIENT_IDLE_TIMEOUT: &#39;10s&#39;
      HTTP_CONNECTION_POOL_MAX_OPEN_REQUESTS: 1024
      HTTP_CONNECTION_POOL_MAX_RETRIES: 3
      HTTP_CONNECTION_POOL_MAX_CONNECTIONS: 1024
      HTTP_CONNECTION_POOL_SUBSCRIPTION_TIMEOUT: &#39;60 seconds&#39;
      USE_RESULT_ELEMENT_GROUPING: &#39;true&#39;
      RESULT_ELEMENT_GROUPING_COUNT: 2000
      RESULT_ELEMENT_GROUPING_INTERVAL_IN_MS: 1000
      RESULT_ELEMENT_GROUPING_PARALLELISM: 1
      USE_AGGREGATOR_BACKPRESSURE: &#39;true&#39;
      AGGREGATOR_RECEIVE_PARALLELISM: 32
      MAX_NR_BATCH_RETRIES: 2
      # persistence mode is one of [&#39;AWS&#39;, &#39;GCP&#39;, &#39;LOCAL&#39;, &#39;CLASS&#39;]
      PERSISTENCE_MODE: &#39;CLASS&#39;
      PERSISTENCE_MODULE_CLASS: &#39;de.awagen.kolibri.base.config.di.modules.persistence.LocalPersistenceModule&#39;
      # properties in case PERSISTENCE_MODE is &#39;AWS&#39; (or &#39;CLASS&#39; and AwsPersistenceModule is referenced in PERSISTENCE_MODULE_CLASS)
      AWS_PROFILE: &#39;developer&#39;
      AWS_S3_BUCKET: &#39;kolibri-dev&#39;
      AWS_S3_PATH: &#39;metric_test&#39;
      AWS_S3_REGION: &#39;EU_CENTRAL_1&#39;
      # properties in case PERSISTENCE_MODE is &#39;LOCAL&#39; (or &#39;CLASS&#39; and LocalPersistenceModule is referenced in PERSISTENCE_MODULE_CLASS)
      LOCAL_STORAGE_WRITE_BASE_PATH: : &#39;/app/data&#39;
      LOCAL_STORAGE_WRITE_RESULTS_SUBPATH: &#39;test-results&#39;
      LOCAL_STORAGE_READ_BASE_PATH: : &#39;/app/data&#39;
      # properties in case PERSISTENCE_MODE is &#39;GCP&#39; (or &#39;CLASS&#39; and GCPPersistenceModule is referenced in PERSISTENCE_MODULE_CLASS)
      GCP_GS_BUCKET: [bucket name without gs:// prefix]
      GCP_GS_PATH: [path from bucket root to append to all paths that are requested]
      GCP_GS_PROJECT_ID: [the project id for which the used service account is defined and for which the gs bucket was created]
      # JOB_TEMPLATES_PATH must be relative to the base path or bucket path, depending on the persistence selected
      JOB_TEMPLATES_PATH: &#39;templates/jobs&#39;
      JUDGEMENT_FILE_SOURCE_TYPE: &#39;CSV&#39;
      # if judgement file format set to &#39;JSON_LINES&#39;, need to set &#39;DOUBLE&#39; in case judgements are numeric in the json,
      # if the numeric value is represented as string, use &#39;STRING&#39;. This purely refers to how the json value is interpreted,
      # later this will be cast to double either way
      JUDGEMENT_FILE_JSON_LINES_JUDGEMENT_VALUE_TYPE_CAST: &#39;STRING&#39;
      # if ure requesting via https yet ne server provides no valid certificate
      USE_INSECURE_SSL_ENGINE: &#39;true&#39;
      # properties if discovery mode is kubernetes-api
      # (Optional) path to file where namespath is written in file. Available by default when setting namespace in k8s charts for the deployment / pod
      K8S_DISCOVERY_POD_NAMESPACE_PATH: &#39;/var/run/secrets/kubernetes.io/serviceaccount/namespace&#39;
      # namespace to which pods are assigned, if not set properly k8s access rights will not allow them finding each other.
      # make sure this corresponds to the namespace you deploy in. If set, K8S_DISCOVERY_POD_NAMESPACE_PATH doesnt have effect.
      K8S_DISCOVERY_POD_NAMESPACE: &#39;kolibri&#39;
      # label selector by which to identify the right pods
      K8S_DISCOVERY_POD_LABEL_SELECTOR: &#39;app=%s&#39;
    volumes:
      - ./test-files:/app/data
      - [absolute-path-containing-your-aws-config-folder]/.aws:/home/kolibri/.aws:ro
      - [path-to-dir-containing-key-file-on-local-machine]/:/home/kolibri/gcp:ro
</code></pre><h2 id=configuration-options-in-detail>Configuration Options in Detail</h2><table><thead><tr><th><em>Exposed Port Settings</em></th><th>see ports definition above</th></tr></thead><tbody><tr><td><em>HTTP_SERVER_PORT</em></td><td>the port under which to reach the endpoints exposed by the application</td></tr><tr><td><em>KAMON_PROMETHEUS_PORT</em></td><td>port under which to scrape metrics in prometheus format</td></tr><tr><td><em>KAMON_STATUSPAGE_PORT</em></td><td>kamon statuspage port. Kamon exposes this endpoint as status overview of which metrics are collected</td></tr></tbody></table><table><thead><tr><th>General Setup Settings</th><th></th></tr></thead><tbody><tr><td><em>PROFILE</em></td><td>determines which application-[profile].conf file is picked up for config settings</td></tr><tr><td><em>ROLES</em></td><td>either <code>httpserver</code>, <code>compute</code> or both <code>httpserver,compute</code> (comma-separated). If httpserver is within the option, node starts http server on the defined HTTP_SERVER_PORT and exposes the application endpoints. If compute is set, the node is used for computations.</td></tr><tr><td><em>KAMON_PROMETHEUS_PORT</em></td><td>port under which kamon exposes prometheus metrics to be scraped</td></tr><tr><td><em>KAMON_STATUSPAGE_PORT</em></td><td>port on which kamon status page is exposed</td></tr><tr><td><em>CLUSTER_NODE_HOST</em></td><td>cluster node host</td></tr><tr><td><em>CLUSTER_NODE_PORT</em></td><td>cluster node port</td></tr><tr><td><em>HTTP_SERVER_INTERFACE</em></td><td>http server interface for the http server (only needed if httpserver is one of the above defined ROLES)</td></tr><tr><td><em>HTTP_SERVER_PORT</em></td><td>in case one of the node roles is &lsquo;httpserver&rsquo;, the routes are exposed on that port</td></tr><tr><td><em>MANAGEMENT_HOST</em></td><td>management host</td></tr><tr><td><em>MANAGEMENT_PORT</em></td><td>management port</td></tr><tr><td><em>MANAGEMENT_BIND_HOSTNAME</em></td><td>management bind host name</td></tr><tr><td><em>MANAGEMENT_BIND_PORT</em></td><td>management bind port</td></tr><tr><td><em>CLUSTER_NODE_BIND_HOST</em></td><td>bind host for cluster node</td></tr><tr><td><em>CLUSTER_NODE_BIND_PORT</em></td><td>bind port for cluster node, should be same for all nodes in the cluster</td></tr><tr><td><em>DISCOVERY_SERVICE_NAME</em></td><td>the service name used for node discovery. Must be same for all nodes of the cluster</td></tr><tr><td><em>KOLIBRI_ACTOR_SYSTEM_NAME</em></td><td>the name of the ActorSystem to use for the Kolibri application</td></tr><tr><td><em>DISCOVERY_METHOD</em></td><td>cluster node discovery method to use. Can be &lsquo;aws-api-ec2-tag-based&rsquo; (based on ec2 instance tags in AWS), &lsquo;config&rsquo; (defining the endpoints per config), &lsquo;dns&rsquo; or &lsquo;kubernetes-api&rsquo; (see examples for &lsquo;config&rsquo; in the docker-compose.yml and &lsquo;kubernetes-api&rsquo; in the example helm setup). Refer to the akka discovery documentation for details on the differend modes</td></tr><tr><td><em>REQUEST_PARALLELISM</em></td><td>parallelism with which http requests are executed</td></tr><tr><td><em>USE_CONNECTION_POOL_FLOW</em></td><td>&rsquo;true&rsquo;/&lsquo;false&rsquo;. If false, uses single requests API (which should use connection pool under the hood), or flow of requests through connection pool flow (supposed to be more efficient than single request API). Note that it is essential to consume responses directly when they&rsquo;re available to avoid running in timeouts. Note that each &lsquo;.via(someFlow)&rsquo; call is another processing stage whose processing can be delayed relative to the one before, and might cause responses not to be consumed within the timeout if backpressure applied. The single request usage seems to be safer in this regard.</td></tr><tr><td><em>RUNNING_TASK_BASELINE_COUNT</em></td><td>the initial baseline count of concurrently processed batches (this number can be increased via exposed API per job)</td></tr></tbody></table><table><thead><tr><th><em>Kolibri dispatcher settings</em></th><th>Used for the processing provided by Kolibri. Should use majority of resources</th></tr></thead><tbody><tr><td><em>KOLIBRI_DISPATCHER_PARALLELISM_MIN</em></td><td>minimal parallelism</td></tr><tr><td><em>KOLIBRI_DISPATCHER_PARALLELISM_FACTOR</em></td><td>factor applied to number of available processors to determine number of threads</td></tr><tr><td><em>KOLIBRI_DISPATCHER_PARALLELISM_MAX</em></td><td>maximal parallelism</td></tr><tr><td><em>KOLIBRI_DISPATCHER_THROUGHPUT</em></td><td>minimal parallelism</td></tr></tbody></table><table><thead><tr><th><em>Default dispatcher settings</em></th><th>Only used for some internals and kamon metrics handling. Should use only a fraction of resources since majority should be reserved for the kolibri dispatcher (settings above)</th></tr></thead><tbody><tr><td><em>DEFAULT_DISPATCHER_PARALLELISM_FACTOR</em></td><td>factor applied to number of available processors to determine number of threads</td></tr><tr><td><em>DEFAULT_DISPATCHER_PARALLELISM_MAX</em></td><td>maximal parallelism</td></tr><tr><td><em>DEFAULT_DISPATCHER_PARALLELISM_MIN</em></td><td>minimal parallelism</td></tr></tbody></table><table><thead><tr><th><em>Http client/connection pool settings</em></th><th></th></tr></thead><tbody><tr><td><em>HTTP_CLIENT_CONNECTION_TIMEOUT</em></td><td>http client connection timeout, in the format &lsquo;5s&rsquo; (or &lsquo;1m&rsquo; or similar)</td></tr><tr><td><em>HTTP_CLIENT_IDLE_TIMEOUT</em></td><td>http client idle timeout, in the format &rsquo;10s&rsquo; (or &lsquo;1m&rsquo; or similar)</td></tr><tr><td><em>HTTP_CONNECTION_POOL_MAX_OPEN_REQUESTS</em></td><td>max concurrently open requests in the connection pool</td></tr><tr><td><em>HTTP_CONNECTION_POOL_MAX_RETRIES</em></td><td>max retries when executing a request</td></tr><tr><td><em>HTTP_CONNECTION_POOL_MAX_CONNECTIONS</em></td><td>max nr of connections for the connection pool</td></tr><tr><td><em>HTTP_CONNECTION_POOL_SUBSCRIPTION_TIMEOUT</em></td><td>enter a FiniteDuration, e.g for example &lsquo;60 seconds&rsquo; to be used as connection pool subscription timeout</td></tr></tbody></table><table><thead><tr><th>Partial result grouping</th><th><em>These &lsquo;RESULT_ELEMENT*&rsquo; settings determine how many single results are at most collected over a given timespan in an &ldquo;aggregator buffer&rdquo; after which the aggregated ones so far are sent to the actual aggregator. This reduces the single messages sent to aggregator quite a bit.</em></th></tr></thead><tbody><tr><td><em>USE_RESULT_ELEMENT_GROUPING</em></td><td>&rsquo;true&rsquo;/&lsquo;false&rsquo;. Turns on/off the partial result buffering. If turned off, the other &lsquo;RESULT_ELEMENT_GROUPING_*&rsquo; parameters below dont have any effect</td></tr><tr><td><em>RESULT_ELEMENT_GROUPING_COUNT</em></td><td>max elements to group after which the buffer result is sent to the actual aggregator</td></tr><tr><td><em>RESULT_ELEMENT_GROUPING_INTERVAL_IN_MS</em></td><td>maximal interval in ms after which the buffer result, irrespective of how many elements were buffered yet, are sent to the actual aggregator</td></tr><tr><td><em>RESULT_ELEMENT_GROUPING_PARALLELISM</em></td><td>the grouping parallelism</td></tr></tbody></table><table><thead><tr><th>Aggregators, retries, persistence mode</th><th></th></tr></thead><tbody><tr><td><em>USE_AGGREGATOR_BACKPRESSURE</em></td><td>&rsquo;true&rsquo;/&lsquo;false&rsquo;. If set to true, uses ACK messages from the aggregator to apply backpressure on the processing if aggregator can not aggregate fast enough</td></tr><tr><td><em>AGGREGATOR_RECEIVE_PARALLELISM</em></td><td>parallelism with which result messages are sent to the aggregator</td></tr><tr><td><em>MAX_NR_BATCH_RETRIES</em></td><td>defines the number of retries that are executed for failed batches till they succeed</td></tr><tr><td><em>PERSISTENCE_MODE</em></td><td>defines where to write to and read from. Valid values: &lsquo;LOCAL&rsquo;, &lsquo;AWS&rsquo;. If &lsquo;LOCAL&rsquo;, set &lsquo;LOCAL_STORAGE_DIR&rsquo;, if &lsquo;AWS&rsquo; set below &lsquo;AWS_*&rsquo; vars</td></tr><tr><td><em>PERSISTENCE_MODULE_CLASS</em></td><td>if PERSISTENCE_MODE is &lsquo;CLASS&rsquo;, full class path for the module to be loaded (needs a non-args constructor and extend PersistenceDIModule), e.g &lsquo;de.awagen.kolibri.base.config.di.modules.persistence.LocalPersistenceModule&rsquo;</td></tr></tbody></table><table><thead><tr><th>The following settings are just valid if PERSISTENCE_MODE is &lsquo;AWS&rsquo;</th><th></th></tr></thead><tbody><tr><td><em>AWS_PROFILE</em></td><td>this name should match a profile for which there exists a configuration in the .aws folder volume-mounted in the docker-compose definition (e.g &lsquo;developer&rsquo; if such a profile exists)</td></tr><tr><td><em>AWS_S3_BUCKET</em></td><td>the bucket name (without s3:// - prefix). The AWS_PROFILE selected should have rights to read from and write to the bucket</td></tr><tr><td><em>AWS_S3_PATH</em></td><td>the &ldquo;directory&rdquo; path within the bucket defined by &ldquo;AWS_S3_BUCKET&rdquo;. E.g &lsquo;metric_test&rsquo; or &lsquo;folder1/folder2&rsquo; (yep, I know, the conception of &ldquo;directories&rdquo; as such does not exist in s3, but you can use it analogous)</td></tr><tr><td><em>AWS_S3_REGION</em></td><td>the AWS region to utilize. Check com.amazonaws.regions.Regions enum in the utilized AWS lib to see valid values, e.g &lsquo;EU_CENTRAL_1&rsquo;</td></tr></tbody></table><table><thead><tr><th>The following settings are just valid if PERSISTENCE_MODE is &lsquo;LOCAL&rsquo;</th><th></th></tr></thead><tbody><tr><td><em>LOCAL_STORAGE_WRITE_BASE_PATH</em></td><td>should be set to any subPath that the local volume on the host machine is mounted to. Files are written relative to this path</td></tr><tr><td><em>LOCAL_STORAGE_WRITE_RESULTS_SUBPATH</em></td><td>path relative to LOCAL_STORAGE_WRITE_BASE_PATH where results are written in subFolders corresponding to the result output identifiers used in the jobs</td></tr><tr><td><em>LOCAL_STORAGE_READ_BASE_PATH</em></td><td>should be set to any subPath that the local volume on the host machine is mounted to. Files are read relative to this path</td></tr></tbody></table><table><thead><tr><th>The following settings are just valid if PERSISTENCE_MODE is &lsquo;GCP&rsquo;</th><th></th></tr></thead><tbody><tr><td><em>GCP_GS_BUCKET</em></td><td>bucket name without gs:// prefix</td></tr><tr><td><em>GCP_GS_PATH</em></td><td>path from bucket root to append to all paths that are requested</td></tr><tr><td><em>GCP_GS_PROJECT_ID</em></td><td>the project id for which the used service account is defined and for which the gs bucket was created</td></tr><tr><td><em>GOOGLE_APPLICATION_CREDENTIALS</em></td><td>Full path within container to serviceaccount key json file (see below volume mount), e.g &lsquo;/home/kolibri/gcp/[sa-key-file-name].json&rsquo;</td></tr></tbody></table><table><thead><tr><th>The following settings are just valid if DISCOVERY_METHOD is &lsquo;kubernetes-api&rsquo;</th><th></th></tr></thead><tbody><tr><td><em>K8S_DISCOVERY_POD_NAMESPACE_PATH</em></td><td>(Optional) path to file where namespath is written in file. Available by default when setting namespace in k8s charts for the deployment / pod</td></tr><tr><td><em>K8S_DISCOVERY_POD_NAMESPACE</em></td><td>namespace to which pods are assigned, if not set properly k8s access rights will not allow them finding each other. Make sure this corresponds to the namespace you deploy in. If set, K8S_DISCOVERY_POD_NAMESPACE_PATH doesnt have effect.</td></tr><tr><td><em>K8S_DISCOVERY_POD_LABEL_SELECTOR</em></td><td>label selector by which to identify the right pods</td></tr></tbody></table><table><thead><tr><th>The following additional general settings</th><th></th></tr></thead><tbody><tr><td><em>JOB_TEMPLATES_PATH</em></td><td>must be relative to the base path or bucket path, depending on the persistence selected</td></tr><tr><td><em>JUDGEMENT_FILE_SOURCE_TYPE</em></td><td>format the judgement file is given in</td></tr><tr><td><em>JUDGEMENT_FILE_JSON_LINES_JUDGEMENT_VALUE_TYPE_CAST</em></td><td>gives the type to cast the judgement value to in case JUDGEMENT_FILE_SOURCE_TYPE is a json. E.g if numerical values are wrapped in string, such as in &ldquo;0.55&rdquo;, select STRING, in case they&rsquo;re given numerical, use DOUBLE</td></tr><tr><td><em>USE_INSECURE_SSL_ENGINE</em></td><td>if ure requesting via https yet ne server provides no valid certificate</td></tr></tbody></table><table><thead><tr><th>Volumes</th><th>Some mounts needed to access data within docker container</th></tr></thead><tbody><tr><td><em>./test-files:/app/data</em></td><td>mounting workspace test-files folder to /app/data folder within container</td></tr><tr><td><em>[absolute-path-containing-your-aws-config-folder]/.aws:/home/kolibri/.aws:ro</em></td><td>read-only mount of folder on local machine containing aws credentials into standard location in container where its picked up automatically by aws lib</td></tr><tr><td><em>[path-to-dir-containing-key-file-on-local-machine]/:/home/kolibri/gcp:ro</em></td><td>read-only mount of json key file for gcp service account on local machine into location in container where its picked up by setting env variable GOOGLE_APPLICATION_CREDENTIALS to it</td></tr></tbody></table><footer class=footline></footer></div></div><div id=navigation><a class="nav nav-prev" href=/kolibri_archive/kolibri-base/1-basics/ title=Basics><i class="fa fa-chevron-left"></i></a>
<a class="nav nav-next" href=/kolibri_archive/kolibri-base/1-basics/2-monitoring/ title=Monitoring style=margin-right:0><i class="fa fa-chevron-right"></i></a></div></section><div style=left:-1000px;overflow:scroll;position:absolute;top:-1000px;border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px><div style=border:none;box-sizing:content-box;height:200px;margin:0;padding:0;width:200px></div></div><script src=/js/clipboard.min.js?1691615470></script>
<script src=/js/perfect-scrollbar.min.js?1691615470></script>
<script src=/js/perfect-scrollbar.jquery.min.js?1691615470></script>
<script src=/js/jquery.sticky.js?1691615470></script>
<script src=/js/featherlight.min.js?1691615470></script>
<script src=/js/highlight.pack.js?1691615470></script>
<script>hljs.initHighlightingOnLoad()</script><script src=/js/modernizr.custom-3.6.0.js?1691615470></script>
<script src=/js/learn.js?1691615470></script>
<script src=/js/hugo-learn.js?1691615470></script>
<script src=/mermaid/mermaid.js?1691615470></script>
<script>mermaid.initialize({startOnLoad:!0})</script></body></html>